#cloud-config

package_update: true

packages:
  - python3
  - python3-pip

write_files:
  - content: |
      ansible==8.0.0
      PyMySQL==1.0.3
      psycopg2-binary==2.9.6
    path: /usr/local/src/requirements.txt
    owner: root
    permissions: '0644'
  - content: |
      -----BEGIN OPENSSH PRIVATE KEY-----
      b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
      QyNTUxOQAAACDRFDWp81d5NDT4gmlQj0fZX/yWFYbx/oi59w8ytHzW1wAAAJDnSvuM50r7
      jAAAAAtzc2gtZWQyNTUxOQAAACDRFDWp81d5NDT4gmlQj0fZX/yWFYbx/oi59w8ytHzW1w
      AAAECdC7/YFOM3wPov21YaLaa0qBXAImV6F2xvUml2Q6+bUtEUNanzV3k0NPiCaVCPR9lf
      /JYVhvH+iLn3DzK0fNbXAAAADW5rbmlnaHRAYXBnYXI=
      -----END OPENSSH PRIVATE KEY-----
    path: /root/.ssh/id_ed25519
    owner: root
    permissions: '0600'
  - content: |
      ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINEUNanzV3k0NPiCaVCPR9lf/JYVhvH+iLn3DzK0fNbX nknight@apgar
    path: /root/.ssh/id_ed25519.pub
    owner: root
    permissions: '0644'

users:
  - name: root
    ssh_authorized_keys: |
      ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINEUNanzV3k0NPiCaVCPR9lf/JYVhvH+iLn3DzK0fNbX nknight@apgar

runcmd:
  - [python3, -m, pip, install, -r, /usr/local/src/requirements.txt]
