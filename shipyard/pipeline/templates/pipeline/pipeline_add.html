<!-- Django template -->
<!-- Display contents of Methods as a HTML table -->

{% extends "portal/base.html" %}

{% block title %}Pipelines{% endblock %}

{% block javascript %}
    <style>
        #canvas{}
    </style>

    <script src="/static/portal/jquery-2.0.3.min.js"></script>
    <script src="/static/portal/jquery-ui-1.10.4.custom.min.js"></script>
    <script src="/static/pipeline/drydock_objects.js"></script>
    <script src="/static/pipeline/drydock.js"></script>
    <script src="/static/pipeline/pipeline_add.js"></script>
    <script>
        $(function() {
            // see http://jqueryui.com/dialog/#modal-form
            var output_name = $( '#output_name'),
                allFields = $( [] ).add( output_name );

            $( "#dialog-form" ).dialog({
                autoOpen: false,

                // http://stackoverflow.com/questions/896777/remove-close-button-on-jqueryui-dialog
                closeOnEscape: false,
                open: function(event, ui) { $(".ui-dialog-titlebar-close", ui.dialog || ui).hide(); },

                height: 150,
                width: 350,
                modal: true,
                buttons: {
                    "Create output": function() {
                        console.log(name);
                        $( this ).dialog( "close" );
                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function() {
                    allFields.val( "" ).removeClass( "ui-state-error" );
                }
            });
        })
    </script>

{% endblock %}

{% block content %}

<a href="pipelines" rel="prev">Back to pipeline summary</a>

    <!-- CANVAS -->
    <div>
    <canvas id="pipeline_canvas">
        HTML5 Canvas not supported by this browser.
    </canvas>
    </div>

    <!-- Method selector -->
    <div id="pipeline_ctrl">
        <ul id="id_ctrl_nav">
            <li data-rel="#id_meta_ctrl">Pipeline</li>
            <li data-rel="#id_input_ctrl">Inputs</li>
            <li data-rel="#id_method_ctrl">Methods</li>
        </ul>
        
        <form id="id_pipeline_form" action="" method="post" enctype="multipart/form-data">{% csrf_token %}
            <div id="form_ctrl">
                <input type="button" id="id_example_button" value="Example"><input type="button" id="id_delete_button" value="Delete"><input type="button" id="id_reset_button" value="Clear">
                <input type="submit" id="id_submit_button" value="Submit">
                <div class="errortext" id="id_submit_error"></div>
            </div>

            <div id="id_meta_ctrl" class="ctrl_menu">
                <h3>Pipeline</h3>

                <label for="#id_revision_name" class="text-field-label">Pipeline name</label>
                <input id="id_revision_name" maxlength="128" name="revision_name" type="text" />

                <label for="#id_revision_desc" class="text-field-label">Description</label>
                <textarea id="id_revision_desc" name="revision_desc"></textarea>
            </div>
        </form>

        <div id="id_input_ctrl" class="ctrl_menu">
            <h3>Inputs</h3>
            
            <form>
            <label for="#id_datatype_name" class="text-field-label">Label</label>
            <input id="id_datatype_name" maxlength="128" name="datatype_name" type="text" />
            
            <select id="id_select_cdt" name="select_cdt" class="select-label">
                <option value="">Raw</option>
                {% for cdt in compound_datatypes %}
                    <option value={{ cdt.pk }}>{{ cdt }}</option>
                {% endfor %}
            </select>
        
            <input type="submit" id="id_cdt_button" value="Add Input">
            <div class="errortext" id="id_dt_error"></div>
            </form>
        </div>

        <div id="id_method_ctrl" class="ctrl_menu">
            <h3>Methods</h3>

            <form>
            <label for="#id_method_name" class="text-field-label">Label</label>
            <input id="id_method_name" maxlength="128" name="method_name" type="text" />
            
            <select id="id_select_method_family" name="select_method_family">
                <option value="" class="label">Select method family</option>
                {% for family in method_families %}
                    <option value={{ family.pk }}>{{ family.name }}</option>
                {% endfor %}
            </select>
            
            <div id="id_method_revision_field">
            <select id="id_select_method" name="select_method">
                <!-- populated by ajax transaction -->
            </select>
            </div>
            
            <input type="submit" id="id_method_button" value="Add Method">
            <div class="errortext" id="id_method_error"></div>
            </form>
        </div>


    </div>

    <div id="dialog-form" title="">
        <form>
            <fieldset>
                <label for="output_name">Output name</label>
                <input type="text" name="output_name" id="output_name" class="text ui-widget-content ui-corner-all">
            </fieldset>
        </form>
    </div>

{% endblock %}
